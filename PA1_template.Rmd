---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
Just testing first commit.Do we have latex math $y = \sum_{i=1}^n x^i$, Some R-code 

```{r}
a <- 2
b <- 3
a + b
```

New test commit. Had to set up ssh to get push to work from xstudio. I hope it works now.

## Some utility functions and library needed

```{r}
# Function to read ziped files. Solution due to Jack Wasey at Stackoverflow
# In thread http://stackoverflow.com/questions/8986818/automate-zip-file-reading-in-r
read.zip.url <- function(url, filename = NULL, FUN = readLines, ...) {
  zipfile <- tempfile()
  download.file(url = url, destfile = zipfile, quiet = TRUE)
  zipdir <- tempfile()
  dir.create(zipdir)
  unzip(zipfile, exdir = zipdir) # files="" so extract all
  files <- list.files(zipdir)
  if (is.null(filename)) {
    if (length(files) == 1) {
      filename <- files
    } else {
      stop("multiple files in zip, but no filename specified: ", paste(files, collapse = ", "))
    }
  } else { # filename specified
    stopifnot(length(filename) ==1)
    stopifnot(filename %in% files)
  }
  file <- paste(zipdir, files[1], sep="/")
  do.call(FUN, args = c(list(file.path(zipdir, filename)), list(...)))
}
# Looks like we might use dplyr
library(dplyr)
library(zoo)
```


## Loading and preprocessing the data

The data for this assigment is provided as a ziped .csv file. To read the data into R we could first unzip the file in a unix terminal and then read the file with the $\texttt{read.csv()}$ function. At the same time it would be nice to have a general solution to read at ziped file directly into R. A quick search turned up the following solution on Stackoverflow (http://stackoverflow.com/questions/8986818/automate-zip-file-reading-in-r) due to Jack Wasey

```{r}
#Set wd to local git directory
setwd('/Users/ag/dev/gitProjects/RepData_PeerAssessment1')
zipfile <- "activity.zip"
# Use utility function defined above to read in the ziped file
myData <- read.zip.url(paste("file://", zipfile, sep=""), FUN=read.csv, header=TRUE)
head(myData,n=10)
#check class
class(myData)
```

It looks like it might be convenient to have the data as a timeseries object too. Hence we convert the interval variable to a POSIXct object called time. This will be time since midnight. This varible is then paste toghether with the date variable and we obtain a variable dateTime that ought to give a unique point in time. However this does not seems to be the case so there is probably some problem in the dataset. We use the timeDate variable to make a zoo object, but have to exclude duplicate dates.  

```{r}
# generate time from interval
myData$time <- format( as.POSIXct(Sys.Date()) + myData$interval*60, format="%H:%M:%S", tz="UCT")
head(myData,n=10)
myData$dateTime <- as.POSIXct(strptime(paste(myData$date,myData$time), "%Y-%m-%d %H:%M:%S"))
head(myData,20)
myDataZoo <- zoo(myData[! duplicated(myData$dateTime),c(1,4)])
head(myDataZoo,30)
```


## What is mean total number of steps taken per day?

Use dplyr to group the data

```{r}
days <- group_by(myData, as.character(myData$date))
stepsDay <- summarise(days,test=n(),sum(steps))
stepsDay
head(stepsDay[,3])
hist(stepsDay[,3],breaks=15)
#mean number of steps per day
mean(stepsDay[,3], na.rm=TRUE)
#median number of steps per day
median(stepsDay[,3],na.rm=TRUE)
```



## What is the average daily activity pattern?

Use dplyr to group by interval

```{r}
myDataNONA <- myData[! is.na(myData$steps),]
daysInterv <- group_by(myDataNONA, factor(myDataNONA$interval))
stepsInterval <- summarise(daysInterv,test=n(), sum(steps))
head(stepsInterval)
as.numeric(as.character(stepsInterval[,1]))
plot(as.numeric(as.character(stepsInterval[,1])),stepsInterval[,3], type = "l")
paste(as.numeric(as.character(stepsInterval[,1])), as.numeric(as.character(stepsInterval[,3])))
max(stepsInterval[,3])
stepsInterval[stepsInterval$"sum(steps)"=="10927",]
```



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
